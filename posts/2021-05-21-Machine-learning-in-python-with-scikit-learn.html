<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.159">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-05-21">
<meta name="description" content="by Inria team on fun mooc platform">

<title>Guillaume’s blog - Machine learning in python with scikit-learn</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon_small.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-12YC1FPHWN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-12YC1FPHWN', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../styles.css">
<meta name="twitter:title" content="Guillaume’s blog - Machine learning in python with scikit-learn">
<meta name="twitter:description" content="by Inria team on fun mooc platform">
<meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Scikit_learn_logo_small.svg/langfr-220px-Scikit_learn_logo_small.svg.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Guillaume’s blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/castorfou" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/GuillaumeRamel1" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Machine learning in python with scikit-learn</h1>
                  <div>
        <div class="description">
          by Inria team on fun mooc platform
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">machine learning</div>
                <div class="quarto-category">scikit-learn</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 21, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction---machine-learning-concepts" id="toc-introduction---machine-learning-concepts" class="nav-link active" data-scroll-target="#introduction---machine-learning-concepts">Introduction - Machine Learning concepts</a></li>
  <li><a href="#module-1.-the-predictive-modeling-pipeline" id="toc-module-1.-the-predictive-modeling-pipeline" class="nav-link" data-scroll-target="#module-1.-the-predictive-modeling-pipeline">Module 1. The Predictive Modeling Pipeline</a></li>
  <li><a href="#module-2.-selecting-the-best-model" id="toc-module-2.-selecting-the-best-model" class="nav-link" data-scroll-target="#module-2.-selecting-the-best-model">Module 2. Selecting the best model</a></li>
  <li><a href="#module-3.-hyperparameter-tuning" id="toc-module-3.-hyperparameter-tuning" class="nav-link" data-scroll-target="#module-3.-hyperparameter-tuning">Module 3. Hyperparameter tuning</a></li>
  <li><a href="#module-4.-linear-models" id="toc-module-4.-linear-models" class="nav-link" data-scroll-target="#module-4.-linear-models">Module 4. Linear models</a></li>
  <li><a href="#module-5.-decision-tree-models" id="toc-module-5.-decision-tree-models" class="nav-link" data-scroll-target="#module-5.-decision-tree-models">Module 5. Decision tree models</a></li>
  <li><a href="#module-6.-ensemble-of-models" id="toc-module-6.-ensemble-of-models" class="nav-link" data-scroll-target="#module-6.-ensemble-of-models">Module 6. Ensemble of models</a></li>
  <li><a href="#module-7.-evaluating-model-performance" id="toc-module-7.-evaluating-model-performance" class="nav-link" data-scroll-target="#module-7.-evaluating-model-performance">Module 7. Evaluating model performance</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>This is a <a href="https://lms.fun-mooc.fr/courses/course-v1:inria+41026+session01/info">MOOC</a> by Inria team, in charge of scikit-learn.</p>
<blockquote class="blockquote">
<p>After a fair amount of pedagogical and technical preparation work, we offer you today a practical course with:</p>
<ul>
<li>7 modules + 1 introductory module</li>
<li>9 video lessons to explain the main machine learning concepts</li>
<li>71 programming notebooks (you don’t have to install anything) to get hands-on skills</li>
<li>27 quizzes, 7 wrap-up quizzes and 23 exercises to train and deepen your practice</li>
</ul>
</blockquote>
<p><a href="https://lms.fun-mooc.fr/courses/course-v1:inria+41026+session01/496272d6f8444957a7014122a4646116/">Syllabus</a></p>
<p>Introduction: Machine Learning concepts, then</p>
<p>Module 1. The Predictive Modeling Pipeline</p>
<p>Module 2. Selecting the best model</p>
<p>Module 3. Hyperparameter tuning</p>
<p>Module 4. Linear Models</p>
<p>Module 5. Decision tree models</p>
<p>Module 6. Ensemble of models</p>
<p>Module 7. Evaluating model performance</p>
<p><a href="https://github.com/INRIA/scikit-learn-mooc">INRIA github</a> contains everything of this mooc: slides, datasets, notebooks (not videos)</p>
<p>I have forked it, and I use local envt for assignments.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">~/git/guillaume$</span> git clone git@github.com:castorfou/scikit-learn-mooc.git</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">~/git/guillaume$</span> cd scikit-learn-mooc/</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">~/git/guillaume/scikit-learn-mooc$</span> conda env create <span class="at">-f</span> environment.yml</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate scikit-learn-course</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="introduction---machine-learning-concepts" class="level2">
<h2 class="anchored" data-anchor-id="introduction---machine-learning-concepts">Introduction - Machine Learning concepts</h2>
<p><a href="https://inria.github.io/scikit-learn-mooc/slides/?file=ml_concepts.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=ml_concepts.md#1" width="800" height="500" frameborder="0">
</iframe>
</section>
<section id="module-1.-the-predictive-modeling-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="module-1.-the-predictive-modeling-pipeline">Module 1. The Predictive Modeling Pipeline</h2>
<section id="module-overview" class="level6">
<h6 class="anchored" data-anchor-id="module-overview">Module overview</h6>
<blockquote class="blockquote">
<p>The objective in the module are the following:</p>
<ul>
<li>build intuitions regarding an unknown dataset;</li>
<li>identify and differentiate numerical and categorical features;</li>
<li>create an advanced predictive pipeline with scikit-learn.</li>
</ul>
</blockquote>
</section>
<section id="tabular-data-exploration" class="level6">
<h6 class="anchored" data-anchor-id="tabular-data-exploration">Tabular data exploration</h6>
<p>exploration of data: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/01_tabular_data_exploration.ipynb">01_tabular_data_exploration.ipynb</a></p>
<p>exercise M1.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/01_tabular_data_exploration_ex_01.ipynb">01_tabular_data_exploration_ex_01.ipynb</a></p>
</section>
<section id="fitting-a-scikit-learn-model-on-numerical-data" class="level6">
<h6 class="anchored" data-anchor-id="fitting-a-scikit-learn-model-on-numerical-data">Fitting a scikit-learn model on numerical data</h6>
<p>first model with scikit-learn: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/02_numerical_pipeline_introduction.ipynb">02_numerical_pipeline_introduction.ipynb</a></p>
<p>exercise M1.02: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/02_numerical_pipeline_ex_00.ipynb">02_numerical_pipeline_ex_00.ipynb</a></p>
<p>working with numerical data: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/02_numerical_pipeline_hands_on.ipynb">02_numerical_pipeline_hands_on.ipynb</a></p>
<p>exercise M1.03: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/02_numerical_pipeline_ex_01.ipynb">02_numerical_pipeline_ex_01.ipynb</a></p>
<p>preprocessing for numerical features: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/02_numerical_pipeline_scaling.ipynb">02_numerical_pipeline_scaling.ipynb</a></p>
</section>
<section id="handling-categorical-data" class="level6">
<h6 class="anchored" data-anchor-id="handling-categorical-data">Handling categorical data</h6>
<p>Encoding of categorical variables: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/03_categorical_pipeline.ipynb">03_categorical_pipeline.ipynb</a></p>
<blockquote class="blockquote">
<p>Thus, in general <code>OneHotEncoder</code> is the encoding strategy used when the downstream models are <strong>linear models</strong> while <code>OrdinalEncoder</code> is used with <strong>tree-based models</strong>.</p>
</blockquote>
<p>Exercise M1.04: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/03_categorical_pipeline_ex_01.ipynb">03_categorical_pipeline_ex_01.ipynb</a></p>
<p>Using numerical and categorical variables together: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/03_categorical_pipeline_column_transformer.ipynb">03_categorical_pipeline_column_transformer.ipynb</a></p>
<p>Exercise M1.05: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/03_categorical_pipeline_ex_02.ipynb">03_categorical_pipeline_ex_02.ipynb</a></p>
</section>
<section id="wrap-up-quiz" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/predictive_modeling_pipeline/module%201%20-%20wrap-up%20quizz.ipynb">module 1 - wrap-up quizz.ipynb</a></p>
</section>
</section>
<section id="module-2.-selecting-the-best-model" class="level2">
<h2 class="anchored" data-anchor-id="module-2.-selecting-the-best-model">Module 2. Selecting the best model</h2>
<section id="module-overview-1" class="level6">
<h6 class="anchored" data-anchor-id="module-overview-1">Module overview</h6>
<blockquote class="blockquote">
<p>The objective in the module are the following:</p>
<ul>
<li>understand the concept of overfitting and underfitting;</li>
<li>understand the concept of generalization;</li>
<li>understand the general cross-validation framework used to evaluate a model.</li>
</ul>
</blockquote>
</section>
<section id="overfitting-and-underfitting" class="level6">
<h6 class="anchored" data-anchor-id="overfitting-and-underfitting">Overfitting and Underfitting</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=overfitting_vs_underfitting.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=overfitting_vs_underfitting.md#1" width="800" height="500" frameborder="0">
</iframe>
<p>The framework and why do we need it: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_train_test.ipynb">cross_validation_train_test.ipynb</a></p>
</section>
<section id="validation-and-learning-curves" class="level6">
<h6 class="anchored" data-anchor-id="validation-and-learning-curves">Validation and learning curves</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=learning_validation_curves.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=learning_validation_curves.md#1" width="800" height="500" frameborder="0">
</iframe>
<p>Overfit-generalization-underfit: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_validation_curve.ipynb">cross_validation_validation_curve.ipynb</a></p>
<p>Effect of the sample size in cross-validation: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_learning_curve.ipynb">cross_validation_learning_curve.ipynb</a></p>
<p>Exercise M2.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_ex_01.ipynb">cross_validation_ex_01.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_sol_01.ipynb">solution</a></p>
</section>
<section id="bias-versus-variance-trade-off" class="level6">
<h6 class="anchored" data-anchor-id="bias-versus-variance-trade-off">Bias versus variance trade-off</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=bias_vs_variance.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=bias_vs_variance.md#1" width="800" height="500" frameborder="0">
</iframe>
<p><img src="../images/sklearn_bias_variance.png" class="img-fluid"></p>
</section>
<section id="wrap-up-quiz-1" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz-1">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/overfit/overfit_wrap_up_quiz.ipynb">module 2 - wrap-up quizz.ipynb</a></p>
<blockquote class="blockquote">
<ul>
<li><strong>Overfitting</strong> is caused by the <strong>limited size of the training set</strong>, the <strong>noise</strong> in the data, and the <strong>high flexibility</strong> of common machine learning models.</li>
<li><strong>Underfitting</strong> happens when the learnt prediction functions suffer from <strong>systematic errors</strong>. This can be caused by a choice of model family and parameters, which leads to a <strong>lack of flexibility</strong> to capture the repeatable structure of the true data generating process.</li>
<li>For a fixed training set, the objective is to <strong>minimize the test error</strong> by adjusting the model family and its parameters to find the <strong>best trade-off between overfitting for underfitting</strong>.</li>
<li>For a given choice of model family and parameters, <strong>increasing the training set size will decrease overfitting</strong> but can also cause an increase of underfitting.</li>
<li>The test error of a model that is neither overfitting nor underfitting can still be high if the variations of the target variable cannot be fully determined by the input features. This irreducible error is caused by what we sometimes call label noise. In practice, this often happens when we do not have access to important features for one reason or another.</li>
</ul>
</blockquote>
</section>
</section>
<section id="module-3.-hyperparameter-tuning" class="level2">
<h2 class="anchored" data-anchor-id="module-3.-hyperparameter-tuning">Module 3. Hyperparameter tuning</h2>
<section id="module-overview-2" class="level6">
<h6 class="anchored" data-anchor-id="module-overview-2">Module overview</h6>
<blockquote class="blockquote">
<p>The objective in the module are the following:</p>
<ul>
<li>understand what is a model hyperparameter;</li>
<li>understand how to get and set the value an hyperparameter of a scikit-learn model;</li>
<li>be able to fine tune a full predictive modeling pipeline;</li>
<li>understand and visualize the combination of parameters that improves the performance of a model.</li>
</ul>
</blockquote>
</section>
<section id="manual-tuning" class="level6">
<h6 class="anchored" data-anchor-id="manual-tuning">Manual tuning</h6>
<p>Set and get hyperparameters in scikit-learn: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_manual.ipynb">parameter_tuning_manual.ipynb</a></p>
<p>Exercise M3.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_ex_02.ipynb">parameter_tuning_ex_02.ipynb</a></p>
</section>
<section id="automated-tuning" class="level6">
<h6 class="anchored" data-anchor-id="automated-tuning">Automated tuning</h6>
<p>Hyperparameter tuning by grid-search: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_grid_search.ipynb">parameter_tuning_grid_search.ipynb</a></p>
<p>Hyperparameter tuning by randomized-search: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_randomized_search.ipynb">parameter_tuning_randomized_search.ipynb</a></p>
<p>Cross-validation and hyperparameter tuning: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_nested.ipynb">parameter_tuning_nested.ipynb</a></p>
<p>Exercise M3.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_ex_03.ipynb">parameter_tuning_ex_03.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/parameter_tuning_sol_03.ipynb">solution</a></p>
<p><img src="../images/sklearn_plotly_parallel_ccordinates.png" class="img-fluid"></p>
<p>Nice to play with interactive plotly parallel_coordinates to identify best params.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> shorten_param(param_name):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"__"</span> <span class="kw">in</span> param_name:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> param_name.rsplit(<span class="st">"__"</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> param_name</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> pd.read_csv(<span class="st">"../figures/randomized_search_results.csv"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                         index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.parallel_coordinates(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    cv_results.rename(shorten_param, axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">apply</span>({</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"learning_rate"</span>: np.log10,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_leaf_nodes"</span>: np.log2,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"max_bins"</span>: np.log2,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"min_samples_leaf"</span>: np.log10,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"l2_regularization"</span>: np.log10,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean_test_score"</span>: <span class="kw">lambda</span> x: x}),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"mean_test_score"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    color_continuous_scale<span class="op">=</span>px.colors.sequential.Viridis,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="wrap-up-quiz-2" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz-2">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/tuning/tuning_questions.ipynb">module 3 - wrap-up quizz.ipynb</a></p>
<blockquote class="blockquote">
<ul>
<li>Hyperparameters have an impact on the models’ performance and should be wisely chosen;</li>
<li>The search for the best hyperparameters can be automated with a grid-search approach or a randomized search approach;</li>
<li>A grid-search is expensive and does not scale when the number of hyperparameters to optimize increase. Besides, the combination are sampled only on a regular grid.</li>
<li>A randomized-search allows a search with a fixed budget even with an increasing number of hyperparameters. Besides, the combination are sampled on a non-regular grid.</li>
</ul>
</blockquote>
</section>
</section>
<section id="module-4.-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="module-4.-linear-models">Module 4. Linear models</h2>
<section id="module-overview-3" class="level6">
<h6 class="anchored" data-anchor-id="module-overview-3">Module overview</h6>
<blockquote class="blockquote">
<p>In this module, your objectives are to:</p>
<ul>
<li>understand the linear models parametrization;</li>
<li>understand the implication of linear models in both regression and classification;</li>
<li>get intuitions of linear models applied in higher dimensional dataset;</li>
<li>understand the effect of regularization and how to set it;</li>
<li>understand how linear models can be used even with data showing non-linear relationship with the target to be predicted.</li>
</ul>
</blockquote>
</section>
<section id="intuitions-on-linear-models" class="level6">
<h6 class="anchored" data-anchor-id="intuitions-on-linear-models">Intuitions on linear models</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=linear_models.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=linear_models.md#1" width="800" height="500" frameborder="0">
</iframe>
<p>For regression: linear regression</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>linear_regression <span class="op">=</span> LinearRegression()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>linear_regression.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For classification: logistic regression</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>log_reg <span class="op">=</span> LogisticRegression()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>log_reg.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="linear-regression" class="level6">
<h6 class="anchored" data-anchor-id="linear-regression">Linear regression</h6>
<p>Linear regression without scikit-learn: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_regression_without_sklearn.ipynb">linear_regression_without_sklearn.ipynb</a></p>
<p>Exercise M4.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_ex_01.ipynb">linear_models_ex_01.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_sol_01.ipynb">solution</a></p>
<p>usage of <code>np.ravel</code> in</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> goodness_fit_measure(true_values, predictions):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we compute the error between the true values and the predictions of our model</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    errors <span class="op">=</span> np.ravel(true_values) <span class="op">-</span> np.ravel(predictions)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(np.<span class="bu">abs</span>(errors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Linear regression using scjkit-learn: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_regression_in_sklearn.ipynb">linear_regression_in_sklearn.ipynb</a></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>inferred_body_mass <span class="op">=</span> linear_regression.predict(data)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>model_error <span class="op">=</span> mean_squared_error(target, inferred_body_mass)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The mean squared error of the optimal model is </span><span class="sc">{</span>model_error<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="modeling-non-linear-features-target-relationships" class="level6">
<h6 class="anchored" data-anchor-id="modeling-non-linear-features-target-relationships">Modeling non-linear features-target relationships</h6>
<p>Exercise M4.02: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_ex_02.ipynb">linear_models_ex_02.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_sol_02.ipynb">solution</a></p>
<p>Linear regression with non-linear link between data and target: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_regression_non_linear_link.ipynb">linear_regression_non_linear_link.ipynb</a></p>
<p>Exercise M4.03: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_ex_03.ipynb">linear_models_ex_03.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_sol_03.ipynb">solution</a></p>
</section>
<section id="regularization-in-linear-model" class="level6">
<h6 class="anchored" data-anchor-id="regularization-in-linear-model">Regularization in linear model</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=regularized_linear_models.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=regularized_linear_models.md#1" width="800" height="500" frameborder="0">
</iframe>
<p>Ridge regression</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Ridge(alpha<span class="op">=</span><span class="fl">0.01</span>).fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>always use <code>Ridge</code> with a carefully tuned <code>alpha</code>!</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> RidgeCV</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RidgeCV( alphas<span class="op">=</span>[<span class="fl">0.001</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1000</span>] )</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>model.fit(X, y)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.alpha_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Regularization of linear regression model: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_regularization.ipynb">linear_models_regularization.ipynb</a></p>
<p>Exercise M4.04: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_ex_04.ipynb">linear_models_ex_04.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_sol_04.ipynb">solution</a></p>
</section>
<section id="linear-model-for-classification" class="level6">
<h6 class="anchored" data-anchor-id="linear-model-for-classification">Linear model for classification</h6>
<p>Linear model for classification: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/logistic_regression.ipynb">logistic_regression.ipynb</a></p>
<p>Exercise M4.05: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_ex_04.ipynb">linear_models_ex_05.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/linear_models_sol_05.ipynb">solution</a></p>
<p>Beyond linear separation in classification: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/logistic_regression_non_linear.ipynb">logistic_regression_non_linear.ipynb</a></p>
</section>
<section id="wrap-up-quiz-3" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz-3">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/linear_models/module%204%20-%20wrap-up-quizz.ipynb">module 4 - wrap-up quizz.ipynb</a></p>
<blockquote class="blockquote">
<p>In this module, we saw that:</p>
<ul>
<li>the predictions of a linear model depend on a weighted sum of the values of the input features added to an intercept parameter;</li>
<li>fitting a linear model consists in adjusting both the weight coefficients and the intercept to minimize the prediction errors on the training set;</li>
<li>to train linear models successfully it is often required to scale the input features approximately to the same dynamic range;</li>
<li>regularization can be used to reduce over-fitting: weight coefficients are constrained to stay small when fitting;</li>
<li>the regularization hyperparameter needs to be fine-tuned by cross-validation for each new machine learning problem and dataset;</li>
<li>linear models can be used on problems where the target variable is not linearly related to the input features but this requires extra feature engineering work to transform the data in order to avoid under-fitting.</li>
</ul>
</blockquote>
</section>
</section>
<section id="module-5.-decision-tree-models" class="level2">
<h2 class="anchored" data-anchor-id="module-5.-decision-tree-models">Module 5. Decision tree models</h2>
<section id="module-overview-4" class="level6">
<h6 class="anchored" data-anchor-id="module-overview-4">Module overview</h6>
<blockquote class="blockquote">
<p>The objective in the module are the following:</p>
<ul>
<li>understand how decision trees are working in classification and regression;</li>
<li>check which tree parameters are important and their influences.</li>
</ul>
</blockquote>
</section>
<section id="intuitions-on-tree-based-models" class="level6">
<h6 class="anchored" data-anchor-id="intuitions-on-tree-based-models">Intuitions on tree-based models</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=trees.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=trees.md#1" width="800" height="500" frameborder="0">
</iframe>
</section>
<section id="decision-tree-in-classification" class="level6">
<h6 class="anchored" data-anchor-id="decision-tree-in-classification">Decision tree in classification</h6>
<p>Build a classification decision tree: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_classification.ipynb">trees_classification.ipynb</a></p>
<p>Exercise M5.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_ex_01.ipynb">trees_ex_01.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_sol_01.ipynb">solution</a></p>
<p>Fit and decision boundaries</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a palette to be used in the scatterplot</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>palette <span class="op">=</span> [<span class="st">"tab:red"</span>, <span class="st">"tab:blue"</span>, <span class="st">"black"</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>tree.fit(data_train, target_train)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>penguins, x<span class="op">=</span>culmen_columns[<span class="dv">0</span>], y<span class="op">=</span>culmen_columns[<span class="dv">1</span>],</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                     hue<span class="op">=</span>target_column, palette<span class="op">=</span>palette)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>plot_decision_function(tree, range_features, ax<span class="op">=</span>ax)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.title(<span class="st">"Decision boundary using a decision tree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Decision tree</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> plot_tree</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">17</span>, <span class="dv">12</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plot_tree(tree, feature_names<span class="op">=</span>culmen_columns,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>              class_names<span class="op">=</span>tree.classes_, impurity<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>ax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Accuracy</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tree.fit(data_train, target_train)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>test_score <span class="op">=</span> tree.score(data_test, target_test)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of the DecisionTreeClassifier: </span><span class="sc">{</span>test_score<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="decision-tree-in-regression" class="level6">
<h6 class="anchored" data-anchor-id="decision-tree-in-regression">Decision tree in regression</h6>
<p>Decision tree for regression: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_regression.ipynb">trees_regression.ipynb</a></p>
<p>Exercise M5.02: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_ex_02.ipynb">trees_ex_02.ipynb</a> <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_sol_02.ipynb">solution</a></p>
</section>
<section id="hyperparameters-of-decision-tree" class="level6">
<h6 class="anchored" data-anchor-id="hyperparameters-of-decision-tree">Hyperparameters of decision tree</h6>
<p>Importance of decision tree hyperparameters on generalization: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/trees_hyperparameters.ipynb">trees_hyperparameters.ipynb</a></p>
</section>
<section id="wrap-up-quiz-4" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz-4">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/trees/module%205%20-%20wrap-up-quizz.ipynb">module 5 - wrap-up quizz.ipynb</a></p>
<p><a href="https://lms.fun-mooc.fr/courses/course-v1:inria+41026+session01/courseware/6565c007789a4812aea0debb1fb22e0f/0ab58cb806034cdba7bd49e8dd784202/">Main take-away | Main take-away | 41026 Courseware | FUN-MOOC</a></p>
<blockquote class="blockquote">
<p>In this module, we presented decision trees in details. We saw that they:</p>
<ul>
<li>are suited for both regression and classification problems;</li>
<li>are non-parametric models;</li>
<li>are not able to extrapolate;</li>
<li>are sensible to hyperparameter tuning.</li>
</ul>
</blockquote>
</section>
</section>
<section id="module-6.-ensemble-of-models" class="level2">
<h2 class="anchored" data-anchor-id="module-6.-ensemble-of-models">Module 6. Ensemble of models</h2>
<section id="module-overview-5" class="level6">
<h6 class="anchored" data-anchor-id="module-overview-5">Module overview</h6>
<blockquote class="blockquote">
<p>The objective in the module are the following:</p>
<ul>
<li>understanding the principles behind bootstrapping and boosting;</li>
<li>get intuitions with specific models such as random forest and gradient boosting;</li>
<li>identify the important hyperparameters of random forest and gradient boosting decision trees as well as their typical values.</li>
</ul>
</blockquote>
</section>
<section id="intuitions-on-ensemble-of-tree-based-models" class="level6">
<h6 class="anchored" data-anchor-id="intuitions-on-ensemble-of-tree-based-models">Intuitions on ensemble of tree-based models</h6>
<p>video and <a href="https://inria.github.io/scikit-learn-mooc/slides/?file=ensemble.md#1">slides</a></p>
<iframe title="Slides" marginheight="0" src="https://inria.github.io/scikit-learn-mooc/slides/?file=ensemble.md#p" width="800" height="500" frameborder="0">
</iframe>
<p>“Bagging” stands for Bootstrap AGGregatING. It uses bootstrap resampling (random sampling with replacement) to learn several models on random variations of the training set. At predict time, the predictions of each learner are aggregated to give the final predictions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Random Forests</strong> are bagged <em>randomized</em> decision trees</p>
<ul>
<li>At each split: a random subset of features are selected</li>
<li>The best split is taken among the restricted subset</li>
<li>Extra randomization decorrelates the prediction errors</li>
<li>Uncorrelated errors make bagging work better</li>
</ul>
<p><strong>Gradient Boosting</strong></p>
<ul>
<li>Each base model predicts the <strong>negative error</strong> of previous models</li>
<li><code>sklearn</code> use decision trees as the base model</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Implementation of the traditional (exact) method</li>
<li>Fine for small data sets</li>
<li>Too slow for <code>n_samples</code> &gt; 10,000</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> HistGradientBoostingClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Discretize numerical features (256 levels)</li>
<li>Efficient multi core implementation</li>
<li><strong>Much, much faster</strong> when <code>n_samples</code> is large</li>
</ul>
<p><strong>Take away</strong></p>
<ul>
<li><strong>Bagging</strong> and <strong>random forests</strong> fit trees <strong>independently</strong>
<ul>
<li>each <strong>deep tree overfits</strong> individually</li>
<li>averaging the tree predictions <strong>reduces overfitting</strong></li>
</ul></li>
<li>(Gradient) <strong>boosting</strong> fits trees <strong>sequentially</strong>
<ul>
<li>each <strong>shallow tree underfits</strong> individually</li>
<li>sequentially adding trees <strong>reduces underfitting</strong></li>
</ul></li>
<li><strong>Gradient boosting</strong> tends to perform slightly better than <strong>bagging</strong> and <strong>random forest</strong> and furthermore shallow trees predict faster.</li>
</ul>
<p>Introductory example to ensemble models: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_introduction.ipynb">ensemble_introduction.ipynb</a></p>
</section>
<section id="ensemble-method-using-bootstrapping" class="level6">
<h6 class="anchored" data-anchor-id="ensemble-method-using-bootstrapping">Ensemble method using bootstrapping</h6>
<p>Bagging: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_bagging.ipynb">ensemble_bagging.ipynb</a></p>
<p>Wikipedia reference to <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstrapping</a> in statistics.</p>
<p>Exercise M6.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_ex_01.ipynb">ensemble_ex_01.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_sol_01.ipynb">solution</a>)</p>
<p>Random Forest: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_random_forest.ipynb">ensemble_random_forest.ipynb</a></p>
<p>Exercise M6.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_ex_02.ipynb">ensemble_ex_02.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_sol_02.ipynb">solution</a>)</p>
</section>
<section id="ensemble-method-using-boosting" class="level6">
<h6 class="anchored" data-anchor-id="ensemble-method-using-boosting">Ensemble method using boosting</h6>
<p>Adaptive Boosting (AdaBoost): <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_adaboost.ipynb">ensemble_adaboost.ipynb</a></p>
<p>Exercise M6.03: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_ex_03.ipynb">ensemble_ex_03.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_sol_03.ipynb">solution</a>)</p>
<p>Gradient-boosting decision tree (GBDT): <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_gradient_boosting.ipynb">ensemble_gradient_boosting.ipynb</a></p>
<p>Exercise M6.04: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_ex_04.ipynb">ensemble_ex_04.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_sol_04.ipynb">solution</a>)</p>
<p>Speeding-up gradient-boosting: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_hist_gradient_boosting.ipynb">ensemble_hist_gradient_boosting.ipynb</a></p>
</section>
<section id="hyperparameter-tuning-with-ensemble-methods" class="level6">
<h6 class="anchored" data-anchor-id="hyperparameter-tuning-with-ensemble-methods">Hyperparameter tuning with ensemble methods</h6>
<p>Hyperparameter tuning: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_hyperparameters.ipynb">ensemble_hyperparameters.ipynb</a></p>
<p>Exercise M6.05: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_ex_05.ipynb">ensemble_ex_05.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/ensemble_sol_05.ipynb">solution</a>)</p>
</section>
<section id="wrap-up-quiz-5" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz-5">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/ensemble/module%206%20-%20wrap-up-quizz.ipynb">module 6 - wrap-up quizz.ipynb</a></p>
<p>Use of <a href="https://imbalanced-learn.org/stable/">Imbalanced-learn</a> library relying on scikit-learn and provides methods to deal with classification with imbalanced classes.</p>
</section>
</section>
<section id="module-7.-evaluating-model-performance" class="level2">
<h2 class="anchored" data-anchor-id="module-7.-evaluating-model-performance">Module 7. Evaluating model performance</h2>
<section id="module-overview-6" class="level6">
<h6 class="anchored" data-anchor-id="module-overview-6">Module overview</h6>
<blockquote class="blockquote">
<p>The objective in the module are the following:</p>
<ul>
<li>understand the necessity of using an appropriate cross-validation strategy depending on the data;</li>
<li>get the intuitions behind comparing a model with some basic models that can be used as baseline;</li>
<li>understand the principles behind using nested cross-validation when the model needs to be evaluated as well as optimized;</li>
<li>understand the differences between regression and classification metrics;</li>
<li>understand the differences between metrics.</li>
</ul>
</blockquote>
</section>
<section id="comparing-a-model-with-simple-baselines" class="level6">
<h6 class="anchored" data-anchor-id="comparing-a-model-with-simple-baselines">Comparing a model with simple baselines</h6>
<p>Comparing results with baseline and chance level: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_baseline.ipynb">cross_validation_baseline.ipynb</a></p>
<p>Exercise M7.01: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_ex_02.ipynb">cross_validation_ex_02.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_sol_02.ipynb">solution</a>)</p>
</section>
<section id="choice-of-cross-validation" class="level6">
<h6 class="anchored" data-anchor-id="choice-of-cross-validation">Choice of cross-validation</h6>
<p>Introductory exercise regarding stratification: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_ex_03.ipynb">cross_validation_ex_03.ipynb</a></p>
<p>Stratification: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_stratification.ipynb">cross_validation_stratification.ipynb</a></p>
<p>Introductory exercise for sample grouping: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_ex_04.ipynb">cross_validation_ex_04.ipynb</a></p>
<p>Sample grouping: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_grouping.ipynb">cross_validation_grouping.ipynb</a></p>
<p>Introductory exercise for non i.i.d. data: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_ex_05.ipynb">cross_validation_ex_05.ipynb</a></p>
<p>Non i.i.d. data: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_time.ipynb">cross_validation_time.ipynb</a></p>
</section>
<section id="nested-cross-validation" class="level6">
<h6 class="anchored" data-anchor-id="nested-cross-validation">Nested cross-validation</h6>
<p>Nested cross-validation: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/cross_validation_nested.ipynb">cross_validation_nested.ipynb</a></p>
</section>
<section id="introduction-of-the-evaluation-metrics-classification-metrics" class="level6">
<h6 class="anchored" data-anchor-id="introduction-of-the-evaluation-metrics-classification-metrics">Introduction of the evaluation metrics: Classification metrics</h6>
<p>Classification: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/metrics_classification.ipynb">metrics_classification.ipynb</a></p>
<p>Exercise M7.02: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/metrics_ex_01.ipynb">metrics_ex_01.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/metrics_sol_01.ipynb">solution</a>)</p>
</section>
<section id="introduction-of-the-evaluation-metrics-regression-metrics" class="level6">
<h6 class="anchored" data-anchor-id="introduction-of-the-evaluation-metrics-regression-metrics">Introduction of the evaluation metrics: Regression metrics</h6>
<p>Regression: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/metrics_regression.ipynb">metrics_regression.ipynb</a></p>
<p>Exercise M7.03: <a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/metrics_ex_02.ipynb">metrics_ex_02.ipynb</a> (<a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/notebooks/metrics_sol_02.ipynb">solution</a>)</p>
</section>
<section id="wrap-up-quiz-6" class="level6">
<h6 class="anchored" data-anchor-id="wrap-up-quiz-6">Wrap-up quiz</h6>
<p><a href="https://github.com/castorfou/scikit-learn-mooc/blob/master/jupyter-book/evaluation/module%207%20-%20wrap-up-quizz.ipynb">module 7 - wrap-up quizz.ipynb</a></p>
<p>And this completes the course</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/^(?:http:|https:)\/\/castorfou\.github\.io\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>